{% extends "base.html" %}
<!-- {% import "bootstrap/wtf.html" as wtf %} -->

{% block title %}
LOT Polish Airlines Dashboard
{% endblock %}

{% block app_styles %}
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css" integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA==" crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js" integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA==" crossorigin=""></script>
{% endblock %}

{% block app_content %}
	<div class="row">
        <div class="col-md-7">
            <h1>LOT Polish Airlines Dashboard</h1>
            <br>
            <p>Welcome.</p>
        </div>
    </div>
    <br>

    <div class="row">

        <div class="col-md-6">
            <h2>Chicago to Kraków Passenger Counts</h2>
            <canvas id="myChart"></canvas>
        </div>

        <div class="col-md-6">
            <h2>Map</h2>
            <br>
            <div id="mapid" style="width: 100%; height: 400px;"></div>
        </div>

    </div>

    <br>
    <hr>
    <br>
    <div class = "row">
        <div class="col-md-8">
        <h2>Raw Data</h2>
        <table class="table">
          	<thead>
                <tr>
                	<th scope="col">Airline</th>
                	<th scope="col">Month</th>
                	<th scope="col">Origin</th>
                	<th scope="col">Dest</th>
            		<th scope="col">Seats</th>
            		<th scope="col">Passengers</th>
                </tr>
          	</thead>
          	<tbody>
              	{% for item in data %}
                <tr>
                	<td>{{ item[0] }}</td>
                	<td>{{ item[1] }}</td>
                	<td>{{ item[2] }}</td>
                	<td>{{ item[3] }}</td>
                	<td>{{ item[4] }}</td>
                	<td>{{ item[5] }}</td>
                </tr>
            	{% endfor %}
          </tbody>
        </table>
        </div>
    </div>

{% endblock %}

{%block app_scripts %}
    <script>

    var mymap = L.map('mapid').setView([54.571309, -22.850261], 2);

    L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
        maxZoom: 18,
        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, ' +
            '<a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
            'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
        id: 'mapbox.streets'
    }).addTo(mymap);

    L.marker([50.077778, 19.784722]).addTo(mymap)
        .bindPopup("<b>KRK</b><br />Kraków Airport.");

    L.marker([41.978611, -87.904722]).addTo(mymap)
        .bindPopup("<b>ORD</b><br />Chicago O'Hare");

    L.polygon([
        [50.077778, 19.784722],
        [41.978611, -87.904722]
    ]).addTo(mymap).bindPopup("I am KRK-ORD");


    // var popup = L.popup();

    // function onMapClick(e) {
    //     popup
    //         .setLatLng(e.latlng)
    //         .setContent("You clicked the map at " + e.latlng.toString())
    //         .openOn(mymap);
    // }

    // mymap.on('click', onMapClick);

    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.4.0/Chart.min.js"></script>
    <script>
        var ctx = document.getElementById('myChart').getContext('2d');
        var chart = new Chart(ctx, {
        // The type of chart we want to create
        type: 'line',

    // The data for our dataset
        data: {
            labels: [{% for item in west_labels %}
                  "{{ item[0] }}", //tuple handling
              {% endfor %}],
            datasets: [
            {   label: "Westbound: KRK-ORD",
                // backgroundColor: 'rgb(255, 99, 132)',
                borderColor: 'rgb(255, 99, 132)',
                data: [{% for item in west_values %}
                      {{ item[0] }},
                    {% endfor %}],
            },{
                label: "Eastbound: ORD-KRK",
                // backgroundColor: 'cyan',
                borderColor: 'blue',
                data: [{% for item in east_values %}
                      {{ item[0] }},
                    {% endfor %}],
            }]
        },

    // Configuration options go here
        options: {}
    });
    </script>
{% endblock %}